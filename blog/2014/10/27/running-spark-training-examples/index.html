
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Running Spark Training Examples - Data Analytics Clusters on SoftLayer</title>
  <meta name="author" content="Irina Fedulova">

  
  <meta name="description" content="After you have created a data analytics cluster using Vagrant-Cluster tool you certainly will want to see how to use it. Here we present how to run &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://irifed.github.io/vagrant-cluster/blog/2014/10/27/running-spark-training-examples">
  <link href="/vagrant-cluster/favicon.png" rel="icon">
  <link href="/vagrant-cluster/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/vagrant-cluster/atom.xml" rel="alternate" title="Data Analytics Clusters on SoftLayer" type="application/atom+xml">
  <script src="/vagrant-cluster/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/vagrant-cluster/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/vagrant-cluster/">Data Analytics Clusters on SoftLayer</a></h1>
  
    <h2>Usage examples of Vagrant-Cluster tool</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/vagrant-cluster/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:irifed.github.io/vagrant-cluster" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/vagrant-cluster/">Blog</a></li>
  <li><a href="/vagrant-cluster/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Running Spark Training Examples</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-10-27T12:55:04+03:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>27</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>12:55 pm</span></time>
        
      </p>
    
  </header>


<div class="entry-content"><p>After you have created a data analytics cluster using Vagrant-Cluster tool you certainly will want to see how to use it. Here we present how to run hands-on excercises from <a href="https://databricks-training.s3.amazonaws.com/index.html">Spark Training</a> tutorial prepared by <a href="http://databricks.com/">Databricks</a>.</p>

<p>First, get some input data and application templates:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>wget https://s3-us-west-2.amazonaws.com/databricks-meng/usb.zip
</span><span class='line'>unzip usb.zip
</span><span class='line'>cd spark-training/simple-app</span></code></pre></td></tr></table></div></figure>


<h2>Running Sample Application</h2>

<p>In Databrick tutorial examples in <code>spark-training</code> folder are set up to run from local Spark deployment (no cluster) and takes input files from local filesystem by default. But we have a real Spark cluster with HDFS, so we should put our input data to HDFS to be accessible by the cluster, for example to run SampleApp first put some file to HDFS:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>hadoop fs -put ../spark/README.md /</span></code></pre></td></tr></table></div></figure>


<p>and make corresponding changes to <code>src/main/SimpleApp.scala</code> by adding <code>hdfs:///</code> prefix to input file location:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>val logFile = "hdfs:///README.md"</span></code></pre></td></tr></table></div></figure>


<p>After this you can just compile and run SimpleApp to verify that Spark cluster is working:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sbt package
</span><span class='line'>$ /opt/spark/bin/spark-submit --class "SimpleApp" \ 
</span><span class='line'>    --master spark://master:7077 target/scala-2.10/simple-project_2.10-1.0.jar
</span><span class='line'>...
</span><span class='line'>Lines with a: 83, Lines with b: 38</span></code></pre></td></tr></table></div></figure>


<p>Note that we are running <code>sbt</code> without any prefix paths because SBT is installed system-wide on your cluster. Also we submit SimpleApp to the real Spark cluster instead of local using <code>--master spark://master:7077</code> option.</p>

<h2>Spark SQL examples</h2>

<p>Next, move to the next page and try running some Spark SQL examples as described in corresponding part of Databricks <a href="https://databricks-training.s3.amazonaws.com/data-exploration-using-spark-sql.html">tutorial</a>. We will again need to do some tweaks to run examples from Databrick tutorial on our cluster. Spark SQL section of tutorial uses input data stored in <code>spark-training/data</code> folder, so we will put it to HDFS</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cd /root/spark-training
</span><span class='line'>$ hadoop fs -put data /root/data</span></code></pre></td></tr></table></div></figure>


<p>Now you can run all examples from above mentioned <a href="https://databricks-training.s3.amazonaws.com/data-exploration-using-spark-sql.html">Spark SQL</a>section of Databricks Spark Training tutorial.</p>

<h2>Spark Streaming</h2>

<p>To run examples from <a href="https://databricks-training.s3.amazonaws.com/realtime-processing-with-spark-streaming.html">Spark Streaming</a> section of the tutorial we again need to do only few modifications. To compile and submit your Spark Streaming application use following commands instead of those suggested in the tutorial:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sbt assembly
</span><span class='line'>$ /opt/spark/bin/spark-submit --master spark://master:7077 \ 
</span><span class='line'>--class "Tutorial" \
</span><span class='line'>--master spark://master:7077 target/scala-2.10/Tutorial-assembly-0.1-SNAPSHOT.jar</span></code></pre></td></tr></table></div></figure>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Irina Fedulova</span></span>

      




<time class='entry-date' datetime='2014-10-27T12:55:04+03:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>27</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>12:55 pm</span></time>
      


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://irifed.github.io/vagrant-cluster/blog/2014/10/27/running-spark-training-examples/" data-via="" data-counturl="http://irifed.github.io/vagrant-cluster/blog/2014/10/27/running-spark-training-examples/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/vagrant-cluster/blog/2014/10/27/running-spark-training-examples/">Running Spark Training Examples</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Irina Fedulova -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
